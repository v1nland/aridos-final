<!DOCTYPE html>
<html>
    
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<head><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o?o:n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({D5DuLP:[function(t,n){function e(t,n){var e=r[t];return e?e.apply(this,n):(o[t]||(o[t]=[]),void o[t].push(n))}var r={},o={};n.exports=e,e.queues=o,e.handlers=r},{}],handle:[function(t,n){n.exports=t("D5DuLP")},{}],G9z0Bl:[function(t,n){function e(){var t=l.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&p&&p.body){l.proto="https"===f.split(":")[0]||t.sslForHttp?"https://":"http://",i("mark",["onload",a()]);var n=p.createElement("script");n.src=l.proto+t.agent,p.body.appendChild(n)}}function r(){"complete"===p.readyState&&o()}function o(){i("mark",["domContent",a()])}function a(){return(new Date).getTime()}var i=t("handle"),u=window,p=u.document,s="addEventListener",c="attachEvent",f=(""+location).split("?")[0],l=n.exports={offset:a(),origin:f,features:[]};p[s]?(p[s]("DOMContentLoaded",o,!1),u[s]("load",e,!1)):(p[c]("onreadystatechange",r),u[c]("onload",e)),i("mark",["firstbyte",a()])},{handle:"D5DuLP"}],loader:[function(t,n){n.exports=t("G9z0Bl")},{}]},{},["G9z0Bl"]);</script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<base  />
	<title>Ayuda - Simple</title>
    <!-- Bootstrap -->
    <link href="../../../assets/css/bootstrap.min.css" rel="stylesheet" media="screen">
	<link href="../../../assets/css/bootstrap-responsive.min.css" rel="stylesheet">
	<link href="../../../assets/css/theme.css" rel="stylesheet">
	<link rel="shortcut icon" href="../../../assets/img/favicon.png">
    </head>
    <body>
		<div class="container">
			<div class="row">
				<div class="span12">
					<h1><img src="../../../assets/img/logo.png" alt="Ayuda Simple" /></h1>
					<hr />
				</div>
			</div>
			<div class="row">
				<div class="span4">
				<div class="well">
				<ul><li><a href="../../introduccion.html" title="Introducción" >Introducción</a></li>
<li class="active"><a href="../index.html" title="Backend" >Backend</a><ul><li><a href="../ingreso.html" title="Ingreso" >Ingreso</a></li>
<li><a href="../configuracion/index.html" title="Configuración" >Configuración</a><ul><li><a href="../configuracion/inicial.html" title="Inicial" >Inicial</a></li>
<li><a href="../configuracion/grupos.html" title="Grupos" >Grupos</a></li>
<li><a href="../configuracion/usuarios.html" title="Usuarios" >Usuarios</a></li>
<!-- <li><a href="../configuracion/recursos.html" title="Recursos Generales">Recursos Generales</a></li> -->
</ul></li>
<li class="active"><a href="index.html" title="Modelamiento del Proceso" >Modelamiento del Proceso</a><ul><li><a href="generacion-de-documentos.html" title="Generación de Documentos" >Generación de Documentos</a></li>
<li><a href="generacion-de-formularios.html" title="Generación de Formularios" >Generación de Formularios</a></li>
<li><a href="diseno-de-formularios.html" title="Diseño de Formularios" >Diseño de Formularios</a></li>
<li><a href="acciones.html" title="Acciones" >Acciones</a></li>
<li><a href="disenador.html" title="Diseñador" >Diseñador</a></li>
<li><a href="reportes.html" title="Reportes" >Reportes</a></li>
<li class="sactive current"><a href="reglas-de-negocio-y-reglas-de-validacion.html" title="Reglas de Negocio y Reglas de Validación" >Reglas de Negocio y Reglas de Validación</a></li>
<li><a href="../export-import.html" title="Exportar e Importar" >Exportar e importar</a></li>
<!-- Arkhotech -->
<li><a href="categorias.html" title="Categorias">Categorías</a></li>
<!-- <li><a href="recursos.html" title="Asociar Recurso">Asociar Recurso a Trámite</a></li> -->
<li><a href="suscriptores-externos.html" title="Suscriptores Externos" >Suscriptores Externos</a></li>
<li><a href="versionamiento.html" title="Versionamiento de Procesos">Versionamiento de Procesos</a></li>
<!-- Arkhotech -->
</ul></li>
<li><a href="../seguimiento-de-procesos.html" title="Seguimiento de Procesos" >Seguimiento de Procesos</a></li>
<li><a href="../widgets.html" title="Widgets" >Widgets</a></li>
<li><a href="../agenda.html" title="Agenda">Agenda</a></li>
<ul>
	<li><a href="../agenda-listar.html" title="Listar">Listar</a></li>
	<li><a href="../agenda-agregar.html" title="Agregar">Agregar</a></li>
	<li><a href="../agenda-editar.html" title="Editar" >Editar/Eliminar</a></li>
	<li><a href="../agenda-asociar.html" title="Asociar">Asociar a Trámite</a></li>
	<li><a href="../agenda-asistencia.html" title="Control de Asistencia">Control de Asistencia</a></li>
</ul>
</ul></li>
<li><a href="../../frontend/index.html" title="Frontend" >Frontend</a><ul><li><a href="../../frontend/ingreso/index.html" title="Ingreso" >Ingreso</a><ul><li><a href="../../frontend/ingreso/perfil-publico.html" title="Perfil Público" >Perfil Público</a></li>
<li><a href="../../frontend/ingreso/perfil-registrados.html" title="Perfil Registrados" >Perfil Registrados</a></li>
<li><a href="../../frontend/ingreso/perfil-institucional.html" title="Perfil Institucional" >Perfil Institucional</a></li>
</ul>
<li><a href="../../frontend/nuevoHome.html" title="Nuevo Home">Nuevo Home</a></li>
<!-- <li><a href="../../frontend/recursos.html" title="Recursos">Recursos</a></li> -->
<li><a href="../../frontend/agenda.html" title="Agenda Front">Agenda</a></li>
<ul>
	<li><a href="../../frontend/agenda-agendar.html" title="Listar" >Agendar una cita</a></li>
	<li><a href="../../frontend/agenda-editar.html" title="Editar">Editar/Eliminar</a></li>
	<li><a href="../../frontend/agenda-atender.html" title="Editar" >Atender</a></li>
	<li><a href="../../frontend/agenda-revisar.html" title="Eliminar">Revisar</a></li>
	<li><a href="../../frontend/agenda-asistencia.html" title="Asociar">Marcar asistencia</a></li>
</ul>
</ul></li>
<li><a href="../../manager/index.html" title="Manager">Manager</a></li>
	<ul>	
		<li><a href="../../manager/cuentas.html" title="Cuentas">Cuentas</a></li>
		<li><a href="../../manager/feriados.html" title="Días Feriados">Días Feriados</a></li>
    	<li><a href="../../manager/categorias.html" title="Categorias">Categorías</a></li>
<!-- <li><a href="../../manager/recursos.html" title="Recursos Generales">Recursos Generales</a></li> -->
	</ul>
</ul></li>
</ul></li>
</ul>
				</div>
				</div>
				<div class="span8">
				<ul class="breadcrumb">
  <li><a href="../../index.html">Simple</a> <span class="divider">/</span></li><li><a href="../index.html">Backend</a> <span class="divider">/</span></li><li><a href="index.html">Modelamiento del Proceso</a> <span class="divider">/</span></li><li>Reglas de Negocio y Reglas de Validación</li>
</ul>
				<h3>2.3.6                Sintaxis para la correcta aplicación de reglas de negocio y reglas de validación</h3>
<p>Para aplicar reglas de negocio sobre tareas, conectores y/o formularios, es necesario conocer la sintaxis, por este motivo en esta sección se indican los distintos objetos disponibles para aplicar regla de negocio y de validación de campos.</p>
<p> Reglas de Negocio:</p>
<ul>
<li><b>Variables:</b> mantienen el valor de un campo en memoria, Simple admite dos tipos de variables, las variables de formularios y las variables de sesión, para utilizar cada una de estas debe utilizarlas de la siguiente manera:
<ul>
<li><b>Variable de Formulario:</b> tal como se indicó en el apartado de Generación de Formularios, cada campo que se han añadido en los diversos formularios del modelo de proceso se encuentran identificados por su nombre,  para hacer uso del campo, se debe llamar por su variable y esto se realiza anteponiendo dos arrobas (@@) antes del nombre del campo, siendo:
<ul>
<li>Formato general: @@variable_de_formulario
<ul>
<li>Ejemplo de uso de campo: @@direccion_usuario</li>
</ul>
</li>
<li>Las variables no pueden tener espacios entre las palabras, habitualmente se sustituye con el símbolo _</li>
</ul>
</li>
<li><b>Variables de Sesión:</b> las variables de sesión son variables especiales de Simple, que completan la información de acuerdo al usuario que se encuentra registrado (logeado) realizando la etapa del trámite, siendo:
<ul>
<li>Formato general: @!variable_de_sesion</li>
<li>Palabras claves admitidas en Simple: @!rut, @!nombres, @!apellido_paterno, @!apellido_materno, @!email, @!tramite_id(otorga el ID de trámite que se está cursando), @!tramite_proc_cont(otorga el número consecutivo de trámite dentro del proceso que se está cursando), @!fecha_vencimiento(retorna la fecha de vencimiento de una trámite, el cual la tarea fue configurada que tenía vencimiento), @!dias_para_vencer(retorna en un arreglo los días hábiles y días totales que faltan para que la tarea esté vencida. Ejemplo: [5,9]), @!base_url(retorna la url base del sitio)</li>
</ul	>
<li><b>Variables Globales del trámite:</b> estas variables obtienen el conjunto de toda la información que una variable tenga en TODOS los procesos/trámites generados, la forma de identificarlo es con un @#variable, un ejemplo ùtil del uso de esta variable es permitir identificar si una solicitud de trámite ya ha sido solicitada, o si un ciudadano ya solicitó un trámite en particular, esto se realizaría leyendo la variable  @#ciudadano y luego buscando dentro del arreglo que entrega in_array(@#ciudadano) con esto último se validará si el ciudadano está en el arreglo.</li>
</li>
<li><b>Variables de Bandeja de Entrada:</b> Se incluyeron dos nuevas variables de datos de seguimiento (<i>@@tramite_ref, @@tramite_descripcion</i>), para poder mostrar de manera particular la descripción del trámite y un número de referencia no general, tanto en la bandeja de entrada, en sin asignar, en el historial de participados y en seguimiento.  </li>
</ul>
</li>
</ul>
<p> </p>
<ul>
<li>Operadores Lógicos, relacionales y de igualdad: son operadores que permiten realizar comparativas entre un valor u otro.
<ul>
<li>Menor ‘&lt;’: indica que el campo de la izquierda es menor al campo de la derecha, de ser así la sintaxis sería verdadera. Ejemplo: @@edad &lt; 35, si un usuario ingresa la edad en un formulario menor a 35 entonces esta sintaxis sería verdadera.</li>
<li>Mayor ‘&gt;’: indica que el campo de la izquierda es mayor al campo de la derecha, de ser así la sintaxis sería verdadera. Ejemplo: @@edad &gt; 35, si un usuario ingresa la edad en un formulario mayor a 35 entonces esta sintaxis sería verdadera. De lo contrario la sintaxis es falsa.</li>
<li>Menor o igual ‘&lt;=’: indica que el campo de la izquierda es menor o igual al campo de la derecha, de ser así la sintaxis sería verdadera. Ejemplo: @@edad =&lt; 35, si un usuario ingresa la edad en un formulario menor a 35 o igual a 35 entonces esta sintaxis sería verdadera.</li>
<li>Mayor o igual ‘&gt;=’: indica que el campo de la izquierda es mayor o igual al campo de la derecha, de ser así la sintaxis sería verdadera. Ejemplo: @@edad =&lt; 35, si un usuario ingresa la edad en un formulario mayor a 35 o igual a 35 entonces esta sintaxis sería verdadera.</li>
<li>Igual a… ‘==’: indica que el campo de la izquierda es igual al campo de la derecha. Por ejemplo: @@edad_ingreso == @@edad_egreso, se compara el valor de ambas variables y si son iguales entonces la regla es verdadera.</li>
<li>Y ‘&amp;&amp;’: evalúa dos expresiones, si ambas son verdaderas entonces el resultado es verdadero, por ejemplo: @@nombre == ‘pedro’ &amp;&amp; @@edad &lt;= ‘35’, si la instrucción anterior se cumple entonces la regla es verdadera.</li>
<li>O ‘||’: evalúa dos expresiones, si una de ellas es verdadera, entonces el resultado es verdadero, por ejemplo: @@nombre == ‘pedro’ || @@edad &lt;= ‘35’, si la variable @@nombre es diego, pero la variable @@edad es 30, entonces la instrucción se cumple por lo tanto la regla es verdadera.</li>
</ul>
</li>
<li>Funciones matemática: es posible aplicar una serie de funciones matemáticas a las reglas de validación, están son basadas en el lenguaje de programación PHP, entre las cuales se destacan:
<ul>
<li>Sqrt: obtiene la raíz cuadrada de un elemento.</li>
<li>Pow: eleva un número, base con exponente.</li>
<li>Abs: obtiene el valor absoluto de un número.</li>
<li>Log: obtiene el logaritmo de un número.</li>
<li>Dado que son una infinidad de funciones matemáticas incluidas, las cuales están fuera del alcance del manual, puede dirigirse al enlace siguiente, a fin de obtener mayor información:
<ul>
<li><a href="http://php.net/manual/en/book.math.php">http://php.net/manual/en/book.math.php</a> (sitio en inglés).</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> </p>
<p>Ejemplos de aplicación de Regla de Negocio:</p>
<ol>
<li>En el siguiente caso, el formulario se desplegará en modo de visualización únicamente si el Rut es distinto a vacío:</li>
</ol>
<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-45.png" alt="" width="416" height="192" /></p>
<p>Figura 41: "Ejemplo 1 de Aplicación de Regla de Negocio"</p>
<p> </p>
<ol>
<li>El ejemplo siguiente, para el mismo formulario, si el Rut está vacío y la edad es menor o igual a 18, el formulario será visible en modo de edición:</li>
</ol>
<p> </p>
<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-46.png" alt="" width="416" height="209" /></p>
<p>Figura 42: "Ejemplo 2 de aplicación de Regla de Negocio"</p>
<p> </p>

<p>En el caso de que el resultado de una operación entregue un valor booleano(true o false) esta se debe evaluar como string al momento de comparar para luego hacer visible un campo determinado<br>
</p>
<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-49.png" alt="" width="416" height="209" /></p>
<p>Figura 43: "Ejemplo de comparación con datos de tipo booleano para aplicar visibilidad a un campo"</p>

<p>En el caso de querer mostrar un campo para comparar contra un valor null se recomienda en primer lugar realizar una acción de tipo variable y verificar si un dato obtiene un null almacenar un dato de tipo string y luego en el formulario comparar con ese dato de tipo string.<br>
</p>
<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-50.png" alt="" width="416" height="209" /></p>
<p>Figura 44: "Ejemplo de comparación con datos de tipo null para aplicar visibilidad a un campo"</p>
<p> </p>

<ol>
	<li>
					<p>Tabla de equivalencias de reglas de validaciones</p>
	</li>
	</ol>
	<div class="table-responsive">
	<table class="table table-sm table-bordered table-striped">
			<tr>
				<th class="text-center">Regla Simple v1</th>
				<th class="text-center">Regla Simple v2</th>
			</tr>
			<tbody>
				<tr>
					<td >rut</td>
					<td>rut</td>
				</tr>
				<tr>
					<td>required</td>
					<td>required</td>
			</tr>
			<tr>
				<td>matches</td>
				<td>regex:patron</td>
			</tr>
			<tr>
				<td>min_length</td>
				<td>min:num</td>
			</tr>
			<tr>
				<td>max_length</td>
				<td>max:num</td>
			</tr>
			<tr>
				<td>exact_length</td>
				<td>digits:num</td>
			</tr>
			<tr>
				<td>greater_than</td>
				<td>min:num</td>
			</tr>
			<tr>
				<td>less_than</td>
				<td>max:num</td>
			</tr>
			<tr>
				<td>alpha</td>
				<td>alpha</td>
			</tr>
			<tr>
				<td>alpha_numeric</td>
				<td>alpha_num</td>
			</tr>
			<tr>
				<td>alpha_dash</td>
				<td>rut</td>
			</tr>
			<tr>
				<td>numeric</td>
				<td>numeric</td>
			</tr>
			<tr>
				<td>integer</td>
				<td>integer</td>
			</tr>
			<tr>
				<td>is_natural</td>
				<td>integer|min:0</td>
			</tr>
			<tr>
				<td>is_natural_no_zero</td>
				<td>integer|min:1</td>
			</tr>
			<tr>
				<td>valid_email</td>
				<td>email</td>
			</tr>
			<tr>
				<td>valid_emails</td>
				<td>emails</td>
			</tr>
		</tbody>
	</table>
	</div>

<p>Existen además reglas de validación automáticas, las cuales deben ser separadas mediante el símbolo | (tubo) en el campo a validar.<br> 
	Si se quiere que un dato sea opcional y además que sea validado si es ingresado debe ser especificado además como "nullable".<br>
	Ejemplo de RUT opcional y en el caso de ser ingresado que sea validado: "nullable|rut"<br>
</p>
<p>El listado es el siguiente:</p>

<table class="table table-sm table-bordered table-striped">
	<tr>
		<th width="163">Regla</th>
		<th width="83">Parám.de Entrada</th>
		<th width="307">Descripción</th>
		<th width="169">Ejemplo de Uso</th>
	</tr>
	<tr>
	<td>Rut</td>
	<td>No</td>
	<td>Valida campo Rut con su lógica.</td>
	<td> </td>
</tr>
<tr>
	<td>Required</td>
	<td>No</td>
	<td>Señala que el campo debe ser requerido. Retorna Falso si el campo está vacío.</td>
	<td> </td>
</tr>

<tr>
	<td>IP</td>
	<td>No</td>
	<td>Retorna Falso si el campo no es una dirección IP válida.</td>
	<td> </td>
</tr>
<tr>
	<td>Min</td>
	<td>Si</td>
	<td>Retorna Falso si el largo del campo es menor a lo indicado por parámetro.</td>
	<td>min:6</td>
</tr>
<tr>
	<td>Max</td>
	<td>Si</td>
	<td>Retorna Falso si el largo del campo es mayor a lo indicado por parámetro.</td>
	<td>max:12</td>
</tr>
<tr>
	<td>Digits</td>
	<td>Si</td>
	<td>Retorna Falso si el campo contiene cualquier carácter distinto que no sea un digito.</td>
	<td>digits:8</td>
</tr>

<tr>
	<td>Between</td>
	<td>Si</td>
	<td>Retorna Falso si el largo del campo no está en rango indicado por parámetro.</td>
	<td>between:min,max</td>
</tr>
<tr>
	<td>Digits_between</td>
	<td>Si</td>
	<td>Retorna Falso si el campo no está en rango indicado por parámetro.</td>
	<td>digits_between:min,max</td>
</tr>
</tr>
<tr>
	<td>Nullable</td>
	<td>No</td>
	<td>Permite que el campo pueda ser nulo.</td>
	<td></td>
</tr>
<tr>
	<td>Alpha</td>
	<td>No</td>
	<td>Retorna Falso si el campo contiene cualquier carácter distinto al abecedario.</td>
	<td> </td>
</tr>
<tr>
	<td>alpha_num</td>
	<td>No</td>
	<td>Retorna Falso si el campo contiene cualquier carácter distinto a alfanumérico.</td>
	<td> </td>
</tr>
<tr>
	<td>alpha_dash</td>
	<td>No</td>
	<td>Retorna Falso si el campo contiene cualquier carácter distinto a alfanumérico, caracteres numéricos, barras.</td>
	<td> </td>
</tr>
<tr>
	<td>numeric</td>
	<td>No</td>
	<td>Retorna Falso si el campo no es numérico.
</td>
	<td> </td>
</tr>
<tr>
	<td>integer
</td>
	<td>No
</td>
	<td>Retorna Falso si el campo no es un valor entero.
</td>
	<td> </td>
</tr>
<tr>
	<td>Regex
</td>
	<td>Sí
</td>
	<td>Retorna Falso si el campo no coindice con el patron.
</td>
	<td>regex:patron</td>
</tr>
<tr>
	<td>email
</td>
	<td>No
</td>
	<td>Retorna Falso si el campo no es un correo electrónico válido.
</td>
	<td> </td>
</tr>
<tr>
	<td>emails
</td>
	<td>No
</td>
	<td>Retorna Falso si los correos electrónicos indicados en el campo no son correos electrónicos válidos.
</td>
	<td> </td>
</tr>
</tbody>
</table>
<p> 
<h4 id="validacion_campos">Ejemplos de validación de campos:</h4>
<ol>
<li>Para el campo Rut del formulario generado, se validará que se ingrese sea un Rut válido además que el campo sea obligatorio, como se puede visualizar ambas instrucciones se encuentran separadas por | (tubo):</li>
</ol>
	<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-47 height="288" /></p>
<p>Figura 43: "Ejemplo 1 para Validación de Campos"</p>
<p> </p>
<ol>
<li>El siguiente ejemplo, solicita el número de meses con la restricción que sea un número natural distinto a cero:</li>
</ol>
<p> </p>
<p><img src="../../../assets/img/BackEnd/Reglas-Validacion-Negocio/Figura-48.png" alt="" width="454" height="286" /></p>
<p>Figura 44: "Ejemplo 2 para Validación de Campos"</p>
				</div>
			</div>
		</div>


    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="../../../assets/js/bootstrap.min.js"></script>
    <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"beacon-3.newrelic.com","licenseKey":"47c8f5244a","applicationID":"2153681","transactionName":"M1EGYkdYWkUDVERbVgobMURcFl1YBlJIHEkMRA==","queueTime":0,"applicationTime":15,"ttGuid":"","agentToken":"","userAttributes":"","errorBeacon":"bam.nr-data.net","agent":"js-agent.newrelic.com\/nr-411.min.js"}</script></body>

</html>
